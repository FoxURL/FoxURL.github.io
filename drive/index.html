<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fox Drive</title>
  <script src="https://FoxURL.github.io/main.js" defer></script>
  <style>
    body { font-family: sans-serif; background: linear-gradient(135deg,#ff8800,#ffbb33); color: #111; text-align:center; padding:20px; }
    h1 { margin-bottom:10px; }
    .btn { padding:10px 20px;margin:10px;border-radius:20px;background:white;color:#ff6600;cursor:pointer;font-weight:bold;text-decoration:none; }
    .btn:hover { background:#ff6600;color:white; }
    .file-list { margin-top:20px;text-align:left;max-width:600px;margin-left:auto;margin-right:auto; }
    .file-list li { margin:5px 0; }
  </style>
</head>
<body>
  <h1>Fox Drive ðŸ¦Š</h1>
  <p>Storage Used: <span id="used">0</span> / <span id="limit">0</span> bytes</p>
  <p>Files: <span id="count">0</span></p>

  <input type="file" id="fileInput" multiple>
  <button class="btn" id="uploadBtn">Upload File(s)</button>

  <ul class="file-list" id="fileList"></ul>

  <script>
    let driveData = { files: [], totalSize: 0 };
    let storageLimit = 0;

    // Load limits
    fetch('https://FoxURL.github.io/slimit.json')
      .then(res => res.json())
      .then(data => {
        storageLimit = data.basic;
        document.getElementById('limit').textContent = storageLimit;
      });

    // Load drive.json
    fetch('https://FoxURL.github.io/drive.json')
      .then(res => res.json())
      .then(data => {
        driveData = data;
        updateUI();
      });

    function updateUI() {
      document.getElementById('used').textContent = driveData.totalSize;
      document.getElementById('count').textContent = driveData.files.length;
      const list = document.getElementById('fileList');
      list.innerHTML = '';
      driveData.files.forEach(f => {
        const li = document.createElement('li');
        li.textContent = `${f.name} (${f.size} bytes)`;
        list.appendChild(li);
      });
    }

    document.getElementById('uploadBtn').addEventListener('click', () => {
      const input = document.getElementById('fileInput');
      if (!input.files.length) return alert('Select file(s) first');

      for (const file of input.files) {
        if (driveData.totalSize + file.size > storageLimit) {
          alert(`Cannot upload ${file.name}, storage limit exceeded`);
          continue;
        }

        const reader = new FileReader();
        reader.onload = async (e) => {
          const base64 = e.target.result.split(',')[1];

          try {
            const res = await fetch('https://YOUR_BACKEND_URL/upload', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ name: file.name, size: file.size, content: base64 })
            });
            const data = await res.json();
            if (data.success) {
              alert(`${file.name} uploaded successfully!`);
              driveData.totalSize += file.size;
              driveData.files.push({ name: file.name, size: file.size });
              updateUI();
            } else {
              alert('Upload failed: ' + data.error);
            }
          } catch (err) {
            alert('Error connecting to backend');
            console.error(err);
          }
        };
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>
